#!/usr/bin/env python
# !\file

import rospy
import json
from tf2_msgs.msg import TFMessage
import std_msgs

filepath = '/home/github/crafts_extended/json/tcp_frames.json'

def tf_callback(data):
    # rospy.loginfo(data.transforms[0].child_frame_id)
    # rospy.loginfo(data.transforms[0].transform.translation)
    # rospy.loginfo(data.transforms[0].transform.rotation)
    tcp_frame = {"position":data.transforms[0].transform.translation,
                 "rotation":data.transforms[0].transform.rotation
    }
    with open(filepath,'w') as f:
        json.dump(tcp_frame, fp=filepath)

    rospy.signal_shutdown("Data saved")


def worker():
    global freedrive_pub
    rospy.init_node('tool_frame', anonymous=True)
    rospy.Subscriber('/tf', TFMessage, tf_callback)
    freedrive_pub = rospy.Publisher('/ur_hardware_interface/enable_freedrive_mode', std_msgs.Float64, queue_size=10)
    rospy.spin()


if __name__ == '__main__':
    worker()

